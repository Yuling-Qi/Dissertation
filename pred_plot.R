#k=7

#n=200,k=7

pred_lasso.k_7_n_200<-c(0.452087380554416,0.451637565499536,0.454013443520544,0.456192607454019,0.467969982241486,
                        0.501011178682582,0.539950257284081,0.576830743980786,0.601081703848461  )

pred_ridge.k_7_n_200<-c(0.451635292174862, 0.451186927929036, 0.453569430111923, 0.455736414846565, 
                        0.467501012259244, 0.500510167504899, 0.539411306026797, 0.576254912240806, 0.600480622144612

)

pred_ml.k_7_n_200<-c(0.447361640088362,0.447818576230807,0.448330887972886,0.451758991257377,
                     0.46397031776296,0.494186613245632,0.527492351024055,0.561461407425449,0.601277836365146 
)
pred_firth.k_7_n_200<-c(0.449632312455279,0.449397031415246,0.451955679211632,0.450435166063741,
                        0.461881308186883,0.496051166237086,0.52824308692567,0.562193765053897,0.599141073627402 )
pred_flic.k_7_n_200<-c(0.448048944650458,0.44716307747544,0.447483225307263,0.449848923999998,
                       0.459560572040678,0.49602524073669,0.527245443369767,0.564352837815708,0.598344685946744 )

#n=400,k=7

pred_lasso.k_7_n_400<-c(0.453927594792561,0.45512487642474,0.455923849196829,
                        0.457197426877235,0.471962637652534,0.502370686196894,0.549880953774302,0.593122052098798,
                        0.623398592437197)

pred_ridge.k_7_n_400<-c(0.453473667197769, 0.455064975154832, 0.455468925346633, 0.456741229448358,
                        0.471490674014881, 0.501867315510697, 0.549330072820527, 0.592528929046700, 0.622775193844760
)

pred_ml.k_7_n_400<-c(0.451216896438437,0.452583925863382,0.453041047770723,0.455329057183939,
                     0.466082353349337,0.500780202121131,0.538014595228603,0.577672109623103,0.618768128719681 
)

pred_firth.k_7_n_400<-c(0.452315546546589,0.453378990333705,0.452961788388037,0.456711283806633,0.466467851454091,
                        0.503557749473434,0.541912863902433,0.578722071971741,0.623380206039506 )

pred_flic.k_7_n_400<-c(0.451267589205723,0.451287496907413,0.454851941247963,0.45507370113742,
                       0.467502935088389,0.503297197438225,0.538942193040907,0.577955922425572,0.61921285993695 
                       )

#n=800,k=7

pred_lasso.k_7_n_800<-c(0.454482041891730, 0.456720629199660, 0.456261451035324, 0.459507337788682, 
                        0.470855906043256, 0.506188704644195, 0.545718661989855, 0.587792530715063, 0.630919960101971
)

pred_ridge.k_7_n_800<-c(0.454027559849839, 0.456263908569461, 0.455806189584288, 0.459047830349893, 
                        0.470384050996213, 0.505882515939550, 0.545173943328865, 0.587204737184347, 0.630288040140870
)

pred_ml.k_7_n_800<-c(0.45402801287985,0.456264364834825,0.455779672362962,0.459048289496186,0.470385521386869,
                     0.505687017628567,0.545166494627227,0.587196334380683,0.630584376724245 )

pred_firth.k_7_n_800<-c(0.452927056073762,0.455134533218127,0.457589081506251,0.458279522937002,
                        0.469334779965455,0.505712478001282,0.543360412191387,0.587125346966574,0.631542972704358 
)
pred_flic.k_7_n_800<-c(0.454020418067841,0.455667965091491,0.45451874865188,0.457170135365773,
                       0.469981728488197,0.508581198533453,0.543963171993641,0.588620285887686,0.632534954005357 )

#k=5

#n=200,k=5

pred_lasso.k_5_n_200<-c(0.459404438231712, 0.459319435132229, 0.461935418572277, 0.462786407753522, 0.470365690180247, 0.50525004261698, 0.54465567620278, 0.584045706968791, 0.625064611032615


)

pred_ridge.k_5_n_200<-c(0.457464764156106, 0.457381523419609, 0.460900622656178, 
                        0.461744689199458, 0.467976411830183, 0.502434967682055, 
                        0.542690831961229, 0.581484568723599, 0.62038201943104

)

pred_ml.k_5_n_200<-c(0.449857306373603,0.450071988170992,0.451843366897634,0.453668678329107,
                     0.46061238131678,0.495294620739127,0.53294252249954,0.571547609125371,0.612748369799641)

pred_firth.k_5_n_200<-c(0.452344309697737,0.453384364043803,0.45391325962849,0.451763207415677,
                        0.46312297163937,0.500489871794791,0.534996658612387,0.568979063424255,0.610702790243939 
 )

pred_flic.k_5_n_200<-c(0.449227281263417,0.450933575377786,0.452581026783316,0.453441401591977,
                       0.462952122340438,0.496698031913584,0.532009928879875,0.574908584640325,0.614734293359673  )

#n=400,k=5

pred_lasso.k_5_n_400<-c(0.459446999653514, 0.458813213063245, 0.45963976453425, 0.460612184812282, 
                        0.47312552737596, 0.511468677704676, 0.548119407473745, 0.586137853360128, 0.636662327976478
)

pred_ridge.k_5_n_400<-c(0.458804103638160, 0.458126346670481, 0.458842367498758,
                        0.459714446363575, 0.47267882139923, 0.510904777342801,
                        0.546451344236390, 0.584803996313588, 0.635324619425165
)

pred_ml.k_5_n_400<-c(0.454897029359915,0.45328040897351,0.454494816371535,0.456052658229982,
                     0.468441116213822,0.506404631390768,0.542692482647272,0.579344409267355,0.63035874057077 )


pred_firth.k_5_n_400<-c(0.454077272231765,0.45284440318025,0.453981706496189,0.456179693051074,
                        0.467611809581902,0.505352714006175,0.541773910002204,0.582189522723514,0.621665961754663 
 )

pred_flic.k_5_n_400<-c(0.455199942208218,0.454396301267361,0.454585478818323,0.457765417487549,
                       0.467183646723238,0.50500688512592,0.540705275816365,0.581194522728092,0.627205001996  )

#n=800, k=5

pred_lasso.k_5_n_800<-c(0.455484013720396, 0.455269336152564, 0.456026394319257,
                        0.459025388368796, 0.469711375187672, 0.505751918899701,
                        0.547634094237148, 0.589311841124862, 0.633001779627860
)

pred_ridge.k_5_n_800<-c(0.455431488346628, 0.455217094816671, 0.455974493386325, 
                        0.458974489975246, 0.469660317452553, 0.505676893305814, 
                        0.547566460650812, 0.589247929602659, 0.632938011011678
)

pred_ml.k_5_n_800<-c(0.456110591036207,0.455198790854804,0.455373196214119,0.460129916839527,
                     0.469949566709822,0.506440714292793,0.54784049288001,0.588671864811533,0.63448903400711) 

pred_firth.k_5_n_800<-c(0.455940954675071,0.455723059211776,0.456483878198455,
                        0.459284673041837,0.470181556744417,0.506257176277979,0.548182182420569,0.589900741865728,0.633305084712573  )

pred_flic.k_5_n_800<-c(0.455295523009723,0.454696950953249,0.458171386877488,0.458986972967409,
                       0.471002053587168,0.506590808473072,0.548255513280206,0.582835927111602,0.637501527555548  )


## k=3

#n=200,k=3 

pred_lasso.k_3_n_200<-c(0.4665768530313198, 0.46976415262218795, 0.46836519238893263, 
                        0.4714608180527485, 0.47985090874901335, 0.5167046925048625, 
                        0.5607888456759628, 0.5952166343301156, 0.646204220552962
                        
)


pred_ridge.k_3_n_200<-c(0.4661102761782888, 0.4692943884695658, 0.4679968261965437, 
                        0.4711953572346957, 0.47937005783926336, 0.5161879878073579, 
                        0.560227056170286, 0.5949874179957845, 0.645558016332409
                        
)

pred_ml.k_3_n_200<-c(0.461460873151851,0.464637186632688,0.463197698310827,0.465784452651531,
                     0.474088217968383,0.510541768616889,0.554208402687802,0.589317939137533,0.639419889846934 
)

pred_firth.k_3_n_200<-c(0.449757899248992,0.454104145254933,0.455913220822515,0.46449757899363608,
                        0.469748682293765,0.503345786145231,0.540376989406729,0.581364307688869,0.622397058022248 )

pred_flic.k_3_n_200<-c(0.4407551006466632, 0.45060993909688064, 0.4529479723829268, 
                       0.4607551006393628, 0.4660317790444807, 0.4988196540973182,
                       0.5364513287866706, 0.5775484902065953, 0.6188050454775677
)


#n=400,k=3

pred_lasso.k_3_n_400<-c(0.4584773584953291, 0.4598486501464241, 0.46166044077616404,
                        0.46248439166517006, 0.47214276926740585, 0.5085851547793837,
                        0.5502586902869229, 0.5948308756407463, 0.6383379909156452
                        
                        
)


pred_ridge.k_3_n_400<-c(0.4572952856934162, 0.4593074328861536, 0.4608892283121562,
                        0.46195007205732925, 0.47072315139873636, 0.5068895485114978,
                        0.5478205743198185, 0.5928376310959617, 0.6375008675418766
                        
)


pred_ml.k_3_n_400<-c(0.4531954044508217, 0.455097673412301, 0.45614301066946926,
                     0.4569092986783873, 0.4674680685825808, 0.5035506482964196,
                     0.5449095943434871, 0.5884464115254925, 0.6310267236788573
)

pred_firth.k_3_n_400<-c(0.453649053503325,0.45555322663894,0.456600611280749,0.457367666345733,
                        0.467936004587168,0.50405470300042,0.545454049393881,0.590046456982475,0.63265938276262 )

pred_flic.k_3_n_400<-c(0.4504941564738697, 0.45246026037034606, 0.4536871806207322, 
                       0.4544331610190627, 0.4656508145705724, 0.4998328122077226, 
                       0.5412825362160011, 0.5844354487570914, 0.6282245088645574
)



#n=800,k=3
pred_lasso.k_3_n_800<-c(0.459259649127295, 0.459302625295289, 0.461053455313152, 0.463181473748966, 
                        0.475180008457303, 0.511589936704196, 0.552248594917957, 0.599263375593002, 0.645366174154899
 )

pred_ridge.k_3_n_800<-c(0.45903116173967, 0.459074116526486, 0.460824075484638, 0.462951035204812,
                        0.474943600492897, 0.511335414347627, 0.551973844373222, 0.59896523461012, 0.645045096456315
)

pred_ml.k_3_n_800<-c(0.457431750026291, 0.45747455514486, 0.45921841668504, 0.461337965395736,
                     0.47328874474205, 0.509553757851642, 0.550050590560075, 0.596878247729945, 0.642797552566223
)

pred_firth.k_3_n_800<-c(0.45697477525104,0.457017537607253,0.458759657028012,0.460877088307429,
                        0.472815928813237,0.509044713138504,0.549501089470604,0.596281965764181,0.642155397169054 )

pred_flic.k_3_n_800<-c(0.4546006053750936, 0.4546994435725464, 0.4560124230716132, 
                       0.4582257861511034, 0.4700961991577542, 0.5068789931544737,
                       0.546961444054306, 0.5947773280857153, 0.6384816635955369
)


par(mfrow=c(3,3))
par(mar=c(2, 2, 2, 2))
op <- par(cex = 1)
margin <- c(5, 4, 4, 2)

x <- c(-log(9), -log(7), -log(5), -log(3), 0, log(3), log(5), log(7), log(9))

ridge_color<-"#E74C3C"
lasso_color<-"#3498DB"
ml_color<-"#E67E22"
firth_color<-"#2ECC71"
flic_color<-"#F9D423"

# Define line styles and colors
line_styles <- c(1, 2, 3, 4, 5)  # Different line styles
line_colors <- c("#E74C3C", "#3498DB", "#E67E22", "#2ECC71", "#F9D423")  # Different line colors

# Load necessary libraries
library(grDevices)
# Define k values
k_values <- c(7, 5, 3)

# Define n values
n_values <- c(200, 400, 800)


# Define n values
n_values <- c(200, 400, 800)

# y_limits <- list(
#      k1_n1 = c(0, 80),
#      k1_n2 = c(0, 30),
#      k1_n3 = c(0, 40),
#      k2_n1 = c(0, 80),
#      k2_n2 = c(0, 20),
#      k2_n3 = c(0, 70),
#      k3_n1 = c(0, 80),
#      k3_n2 = c(0, 80),
#      k3_n3 = c(0, 80)
# )

# Define k values
k_values <- c(7, 5, 3)

# Define n values
n_values <- c(200, 400, 800)

# Loop over n values
for (n in n_values) {
     # Create a new plot for each n value
     par(mfrow=c(1,1))
     par(mar=c(4, 4, 2, 2))
     
     # Loop over k values
     for (k in k_values) {
          # Create variable names
          var_prefix <- paste("k", k, "n", n, sep = "_")
          
          # Load data
          lasso <- get(paste("pred_lasso", var_prefix, sep = ".")) * 10
          ridge <- get(paste("pred_ridge", var_prefix, sep = ".")) * 10
          ml <- get(paste("pred_ml", var_prefix, sep = ".")) * 10
          firth <- get(paste("pred_firth", var_prefix, sep = ".")) * 10
          flic <- get(paste("pred_flic", var_prefix, sep = ".")) * 10
          
          # Plot
          plot(x, lasso, xaxt = 'n',
               type = "b", col = line_colors[1], pch = 18, lty = line_styles[1],
               ylab = "RMSE * sqrt (n)", xlab = "True beta",
               # ylim = y_limits[[paste("k", k, "_n", n, sep = "")]],
               ylim = c(4.4,6.5),
               main = paste("Poisson regression model, n =", n), cex.main = 1)
          axis(side = 1, at = round(x, 2), labels = TRUE, cex.axis = 0.8)
          lines(x, ridge, type = "b", col = line_colors[2], pch = 18, lty = line_styles[2])
          lines(x, ml, type = "b", col = line_colors[3], pch = 18, lty = line_styles[3])
          lines(x, firth, type = "b", col = line_colors[4], pch = 18, lty = line_styles[4])
          lines(x, flic, type = "b", col = line_colors[5], pch = 18, lty = line_styles[5])
          legend("topleft", legend = c("Lasso", "Ridge", "ML", "Firth", "FLIC"),
                 col = line_colors, lty = line_styles, cex = 1)
          
          # Add k value in the bottom left corner
          mtext(paste("k=", k), side = 1, at = log(5), line = -1, cex = 1.5)
          
         
     }
}



