#n=200,k=7

lasso.k_7_n_200<-c(1.6212812, 1.2254892, 1.0288798, 0.6005829, 0.1320624, 0.6615774,
                   0.7011407, 0.3910884, 0.3323033)

ridge.k_7_n_200<-c(1.4885480, 1.1212422, 1.0051251, 0.5699797, 0.2102510, 0.5029217,
                   0.6816826, 0.6194847, 0.7073489
)
ml.k_7_n_200<-c(12.272597492902,12.0321167438513,11.2235245713888,9.68610736886489,
                3.98662274875942,0.745147248847117,0.382890125283111,0.35927551124118,0.325066305960564 )
firth.k_7_n_200<-c(0.997500753598055,0.886067527769011,0.810387786952567,0.763943194394549,0.660153613030082,
                   0.448856962792294,0.376314648636485,0.347496722926416,0.32409009996827 )

#n=400,k=7

lasso.k_7_n_400<-c(1.43608847, 1.349359781, 1.051016635, 0.638853256, 0.169674652, 
                   0.477216495, 0.516086478, 0.450460077, 0.312271557
 )

ridge.k_7_n_400<-c(1.3604413144, 1.2938379517, 1.0031490971, 0.5296935374, 0.1970737002, 
                   0.4717801547, 0.5940242373, 0.6541674878, 0.7239108349
)

ml.k_7_n_400<-c(8.9210376441782,7.96237146789724,6.73766180478708,4.09086578839171,
                0.433544214277673,0.269032086137403,0.221076198940339,0.200212408800346,0.183105608091315 )

firth.k_7_n_400<-c(0.762236730560448,0.757452222732538,0.738923250310832,0.726292894167226,0.495543143047312,
                   0.294619609045052,0.250513312802575,0.235971509908399,0.215481135191791 
)

#n=800,k=7

lasso.k_7_n_800<-c(1.2786176259, 1.2342675926, 0.9855793561, 0.6543306899, 0.1095172295, 
                   0.4830528882, 0.4661491202, 0.3245986547, 0.2905189326
)

ridge.k_7_n_800<-c(1.1582201455, 1.1042031536, 0.8791095705, 0.5252038346, 
                   0.1659628877, 0.364008072, 0.4912951937, 0.4518669871, 0.4486115457
)

ml.k_7_n_800<-c(7.40411238494588,6.68072032535474,4.96545344087955,2.18788138863324,
                0.336629651515031,0.211422103130829,0.179861251284926,0.16513061617261,0.146893883554776)

firth.k_7_n_800<-c(0.722221255568763,0.715958412184359,0.66495606768594,0.551717770637463,0.315361698332587,
                   0.199161338287501,0.176353961342434,0.1596134709712,0.154509946546953  )

#k=5

#n=200,k=5

lasso.k_5_n_200<-c(2.10393261843638,1.79782028213673,1.24026103839516,0.700690003709775,
                   0.23463345,0.443739764975972,0.356819995238981,0.32159207771383,0.290783037026987 
 )

ridge.k_5_n_200<-c(1.834124, 1.664513, 1.283715, 0.641975, 0.161614, 0.545067, 0.812921, 0.859079, 0.817963)

ml.k_5_n_200<-c(12.2671235530955,11.6989000332517,11.2412132578827,9.58994971426826,
                4.33735756066893,0.922338579706536,0.39093966347539,0.352636063048878,0.330859887622623 
)

firth.k_5_n_200<-c(0.993191047382804,0.888217257030331,0.77971630985691,0.778093198624492,
                   0.691446419869104,0.415622521749103,0.369022403320492,0.319963304603014,0.311950418927788 )

#n=400,k=5

lasso.k_5_n_400<-c(1.74626012133873,1.49612078513903,1.07186973451558,0.595734597745047,
                   0.166147018477021,0.440626072118398,0.37793502260286,0.2394073638262,0.34291951281459)

ridge.k_5_n_400<-c(1.617212, 1.507187, 1.171223, 0.7068645, 0.1986282, 0.5299195, 0.5777736, 0.5098964, 0.3637949)

ml.k_5_n_400<-c(10.2362046476604,9.74308903721187,8.30732809044085,6.09244039042248,
                1.43828583203378,0.314354042833671,0.248969115692504,0.224061208486061,0.223614423605434 )


firth.k_5_n_400<-c(0.763871302229622,0.743783657067714,0.740736660315943,0.694652447080968,
                   0.451175546038444,0.285973566371827,0.253281606389739,0.220721026891584,0.214643520379828 
)

#n=800, k=5

lasso.k_5_n_800<-c(1.28855899, 0.97419822, 0.81707406, 0.47772553, 0.10499276, 0.52576651,
                   0.55708702, 0.31129664, 0.26409981
)
ridge.k_5_n_800<-c(1.18313539, 0.89068299, 0.79772906, 0.45262659, 0.16699887,
                   0.39916455, 0.54018401, 0.49215285, 0.56182508
)

ml.k_5_n_800<-c(7.41164856894973,6.41854220222173,4.82846450026038,2.24498311553312,
                0.359245678127449,0.212151208651109,0.178733507053195,0.1586516818912,0.150777988624782 )

firth.k_5_n_800<-c(0.723730893165251,0.711933781812775,0.660386042462957,0.562727145736422,
                   0.335135773082532,0.198281554214257,0.175467815148027,0.160121560887801,0.150724286529907  )


## k=3

#n=200,k=3 

lasso.k_3_n_200<-c(1.782337, 1.635864, 1.316784, 0.7055916, 0.1278699, 0.5316528, 0.8996431, 0.9187439, 0.7889845)


ridge.k_3_n_200<-c(1.707615, 1.551842, 1.263053, 0.6268694, 0.1976941, 0.4586363, 0.9160836, 1.034356, 0.977522)

ml.k_3_n_200<-c(12.1935596823198,11.7297915792071,11.4976743597185,9.31022360092826,4.1036784301754,
                0.696187627258418,0.378570935721415,0.333754109260911,0.31417574675143)

firth.k_3_n_200<-c(0.98741833031828,0.863002783103964,0.830710329807467,0.771467230535699,
                   0.675358359477155,0.451528777657481,0.386401906908182,0.334940678659745,0.315497033916899 
)


#n=400,k=3

lasso.k_3_n_400<-c(1.715957, 1.486664, 1.184242, 0.7193834, 0.1228058, 0.5577956, 0.6535342, 0.5752437, 0.4605407)


ridge.k_3_n_400<-c(1.542784, 1.406898, 1.133806, 0.6424193, 0.1774821, 0.4987767, 0.6975947, 0.7503055, 0.7212525)


ml.k_3_n_400<-c(10.0822150350924,9.28110531909763,7.94596483271824,5.17731773331467,
                1.3562567615067,0.29632850748421,0.247722387839428,0.231405910636528,0.209612700506116 
 )

firth.k_3_n_400<-c(0.77884577160096,0.769293180428581,0.753075165374031,
                   0.664566329739932,0.477260897888808,0.290619924356339,0.273933362444973,0.232035810350009,0.220300333437453 
)



#n=800,k=3
lasso.k_3_n_800<-c(1.36059151689875,1.04876431749427,0.609028115472204,0.509836069415027,
                   0.237348420301067,0.18706898800061,0.170072599444115,0.164702408734839,0.114038832928252  )

ridge.k_3_n_800<-c(1.253892, 0.946501, 0.6483711, 0.481074, 0.1775421, 0.4246004, 0.574877, 0.5228447, 0.5960639)

ml.k_3_n_800<-c(7.30770529706291,6.13523423760825,4.56596177565413,1.94425652813013,
                0.348426232555486,0.202680906518206,0.17364016640938,0.159344322899143,0.150880378190709 
)

firth.k_3_n_800<-c(0.729055406390675,0.724043377906591,0.686532090180307,0.543431072062348,
                   0.321352180479552,0.203047013352677,0.177944456559559,0.161148198000492,0.147051557106001 )

x <- c(-log(9), -log(7), -log(5), -log(3), 0, log(3), log(5), log(7), log(9))

ridge_color<-"#E74C3C"
lasso_color<-"#3498DB"
ml_color<-"#E67E22"
firth_color<-"#2ECC71"

# Define k values
k_values <- c(7, 5, 3)

# Define n values
n_values <- c(200, 400, 800)

# Loop over k and n values
for (k in k_values) {
     for (n in n_values) {
          # Create variable names
          var_prefix <- paste("k", k, "n", n, sep = "_")
          
          # Load data
          lasso <- get(paste("lasso", var_prefix, sep = "."))
          ridge <- get(paste("ridge", var_prefix, sep = "."))
          ml <- get(paste("ml", var_prefix, sep = "."))
          firth <- get(paste("firth", var_prefix, sep = "."))
          
          # Multiply by sqrt(n)
          lasso <- lasso * sqrt(n)
          ridge <- ridge * sqrt(n)
          ml <- ml * sqrt(n)
          firth <- firth * sqrt(n)
          
          # Create a new plot for each combination of k and n
          plot(x, lasso, xaxt = 'n',
               type = "b", col = lasso_color,
               ylab = "RMSE (beta) * sqrt (n)", xlab = "True beta",
               ylim = c(0, 50), main = paste("Poisson regression model, k =", k), pch = 18, cex.main = 0.8)
          axis(side = 1, at = round(x, 2), labels = TRUE, cex.axis=0.8)
          lines(x, ridge, type = "b", col = ridge_color)
          lines(x, ml, type = "b", col = ml_color, pch = 18)
          lines(x, firth, type = "b", col = firth_color)
          legend("topright", legend = c( "ML", "Firth","Lasso", "Ridge"),
                 col = c( ml_color, firth_color,lasso_color, ridge_color), lty = 1, cex = 1)
          
          # Add n value in the bottom left corner
          mtext(paste("n=", n), side = 1, at = -log(5), line = -1, cex = 1.2)
          # Add x and y axis labels
         
     }
}











# par(mfrow=c(3,3))
# par(mar=c(2, 2, 2, 2))
# op <- par(cex = 1)
# margin <- c(5, 4, 4, 2)
# 
# x <- c(-log(9), -log(7), -log(5), -log(3), 0, log(3), log(5), log(7), log(9))
# 
# ridge_color<-"#E74C3C"
# lasso_color<-"#3498DB"
# ml_color<-"#E67E22"
# firth_color<-"#2ECC71"
# 
# # Define k values
# k_values <- c(7, 5, 3)
# 
# # Define n values
# n_values <- c(200, 400, 800)
# 
# # Loop over k and n values
# for (k in k_values) {
#      for (n in n_values) {
#           # Create variable names
#           var_prefix <- paste("k", k, "n", n, sep = "_")
#           
#           # Load data
#           lasso <- get(paste("lasso", var_prefix, sep = "."))
#           ridge <- get(paste("ridge", var_prefix, sep = "."))
#           ml <- get(paste("ml", var_prefix, sep = "."))
#           firth <- get(paste("firth", var_prefix, sep = "."))
#           
#           # Multiply by sqrt(n)
#           lasso <- lasso * sqrt(n)
#           ridge <- ridge * sqrt(n)
#           ml <- ml * sqrt(n)
#           firth <- firth * sqrt(n)
#           
#           # Plot
#           plot(x, lasso, xaxt = 'n',
#                type = "b", col = lasso_color,
#                ylab = "RMSE (beta) * sqrt (n)", xlab = "True beta",
#              
#                ylim = c(0, 50), main = paste("Poisson regression model, k =", k), pch = 18, cex.main = 0.65)
#           axis(side = 1, at = round(x, 2), labels = TRUE, cex.axis=0.8)
#           lines(x, ridge, type = "b", col = ridge_color)
#           lines(x, ml, type = "b", col = ml_color, pch = 18)
#           lines(x, firth, type = "b", col = firth_color)
#           legend("topright", legend = c( "ML", "Firth","Lasso", "Ridge"),
#                  col = c( ml_color, firth_color,lasso_color, ridge_color), lty = 1, cex = 0.5)
#           
#           # Add n value in the bottom left corner
#           mtext(paste("n=", n), side = 1, at = -log(5), line = -1, cex = 0.6)
#           # Add x and y axis labels
#           mtext("True beta", side = 1, line = 2, cex = 0.7)
#           mtext("RMSE(beta) * sqrt (n)", side = 2, line = 2, cex = 0.7)
#      }
# }
